<Window x:Class="PropGen.WPF.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:avalon="http://icsharpcode.net/sharpdevelop/avalonedit"
        xmlns:local="clr-namespace:PropGen.WPF.Views"
        xmlns:controls="clr-namespace:PropGen.WPF.Controls"        
        xmlns:helpers="clr-namespace:PropGen.WPF.Helpers"
        xmlns:behavior="clr-namespace:PropGen.WPF.Behaviors" xmlns:viewmodels="clr-namespace:PropGen.WPF.ViewModels" d:DataContext="{d:DesignInstance Type=viewmodels:MainViewModel}"
        mc:Ignorable="d"
        Title="Propery Generator for MVVM" 
        Width="{Binding AppData.Window.Width, Mode=TwoWay}"
        Height="{Binding AppData.Window.Height, Mode=TwoWay}"         
        Top="{Binding AppData.Window.Top, Mode=TwoWay}" 
        Left="{Binding AppData.Window.Left, Mode=TwoWay}"        
        Loaded="Window_Loaded"
        Closing="Window_Closing"
        MinWidth="1000" MinHeight="450"
        FontFamily="Segoe UI"
        FontSize="10pt"
        Background="LightSkyBlue"
        Icon="/Resources/AppIcon.ico">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Styles/Converters.xaml" />
                <ResourceDictionary Source="/Styles/RoundedButtonStyle.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="150" MinHeight="50" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" MinWidth="200"  />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" MinWidth="200" />
        </Grid.ColumnDefinitions>

        <Menu Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3"
              FontFamily="Segoe UI" FontSize="10pt">
            <MenuItem Header="_File">
                <MenuItem Header="_Exit" Command="{Binding CloseCommand}" />
            </MenuItem>
        </Menu>
        
        <Border Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="3" Margin="5,5,5,0" Padding="0,5" BorderThickness="2" BorderBrush="Red" CornerRadius="5" Background="Transparent" >
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <StackPanel Grid.Column="0" Grid.Row="0" Grid.RowSpan="2" Orientation="Horizontal" VerticalAlignment="Center" Margin="15,5,0,0">
                    <Label Content="File Input" 
                           FontFamily="Segoe UI"
                           FontSize="12pt"/>
                    <controls:ToggleSwitch IsChecked="{Binding IsFileParser }" Margin="10,0" />
                </StackPanel>

                <Label Grid.Column="0" Grid.Row="2" 
                       Content="{Binding ModeText}" 
                       BorderThickness="1"
                       BorderBrush="Black"
                       MaxHeight="28"
                       Width="170"
                       Background="LightYellow"                       
                       HorizontalContentAlignment="Center"                       
                       VerticalContentAlignment="Center"                                              
                       FontFamily="Segoe UI"
                       FontSize="11pt"
                       FontWeight="Bold"
                       Padding="0"                       
                       Margin="10,0,0,0" />

                <CheckBox Grid.Column="1" Grid.Row="0" Content="Wrap in Regions" 
                          IsChecked="{Binding AppData.Options.WrapInRegions}" 
                          Margin="30,10" />
                <CheckBox Grid.Column="1" Grid.Row="1" Content="Compact Style" 
                          IsChecked="{Binding AppData.Options.IsCompactStyle}" 
                          IsEnabled="{Binding AppData.Options.IsMvvmToolkitStyle, Converter={StaticResource InverseBooleanConverter}}" 
                          VerticalAlignment="Center" 
                          Margin="30,0" />
                <CheckBox Grid.Column="1" Grid.Row="2" Content="MVVM Toolkit Style" 
                          IsChecked="{Binding AppData.Options.IsMvvmToolkitStyle}"                           
                          VerticalAlignment="Center" 
                          Margin="30,0" />

                <CheckBox Grid.Column="2" Grid.Row="0" 
                          Content="Implement Notification Interface" 
                          IsChecked="{Binding AppData.Options.ImplementNotificationInterface}" 
                          IsEnabled="{Binding IsFileParser}"
                          Margin="30,10" />

                <Grid Grid.Column="2" Grid.Row="1" Grid.RowSpan="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Label Grid.Row="0" Grid.Column="0" Content="Field Naming Style" Margin="30,0,10,0" />
                    <ComboBox Grid.Row="0" Grid.Column="1"
                              Width="180"
                              ItemsSource="{Binding NamingStyleOptions}"
                              SelectedItem="{Binding SelectedNamingStyle, Mode=TwoWay}"
                              DisplayMemberPath="Value" />

                    <Label Grid.Row="1" Grid.Column="0" 
                           Content="Field Prefix: " 
                           IsEnabled="{Binding SelectedNamingStyle, Converter={StaticResource FieldNamingStyleToBooleanConverter}}"
                           Margin="30,0,10,0" />
                    <TextBox Grid.Row="1" Grid.Column="1"
                             Width="50" 
                             Text="{Binding AppData.Options.FieldPrefix}" 
                             IsEnabled="{Binding SelectedNamingStyle, Converter={StaticResource FieldNamingStyleToBooleanConverter}}"
                             HorizontalAlignment="Left"
                             MaxHeight="24"
                             BorderThickness="1" BorderBrush="Black" Padding="3,0" />
                </Grid>
                
                <StackPanel Grid.Column="2" Grid.Row="1" Orientation="Horizontal" Margin="30,5">
                    
                    
                </StackPanel>
                <StackPanel Grid.Column="2" Grid.Row="2" Orientation="Horizontal" Margin="30,5" 
                            IsEnabled="{Binding SelectedNamingStyle, Converter={StaticResource FieldNamingStyleToBooleanConverter}}">
                    
                    
                </StackPanel>

                <Button Grid.Column="3" Grid.Row="0" Grid.RowSpan="2" Content="Generate" 
                        Command="{Binding GenerateCommand}" 
                        IsEnabled="{Binding InputText, Converter={StaticResource StringNotEmptyConverter}}"
                        Style="{StaticResource RoundedButtonStyle}"
                        helpers:ButtonHelper.CornerRadius="15"
                        FontFamily="Segoe UI"
                        FontSize="16"
                        Margin="10"
                        Padding="10,2" 
                        HorizontalAlignment="Right"
                        Width="150"  />

                <StackPanel Grid.Column="3" Grid.Row="2" Orientation="Horizontal" 
                            Visibility="{Binding IsCopiedToClipboardVisible, Converter={StaticResource BooleanToVisibilityConverter}}"
                            HorizontalAlignment="Right" 
                            VerticalAlignment="Center">
                    <Label Content="Copied to Clipboard" 
                           FontFamily="Segoe UI"
                           FontSize="12pt"
                           Foreground="Green"
                           Margin="0,0,10,0" />
                    <Image Width="32" Height="32" Source="/Resources/copied.png" Margin="0,0,15,0" />
                </StackPanel>

                <StackPanel Orientation="Horizontal" Grid.Column="0" Grid.Row="3" Grid.ColumnSpan="2">
                    <Button 
                            Margin="10,5"                           
                            Width="40"  
                            Height="40"
                            helpers:ButtonHelper.CornerRadius="10"   
                            IsEnabled="{Binding IsFileParser}"
                            Command="{Binding OpenFileCommand}"
                            Style="{StaticResource RoundedButtonStyle}">
                        <Image Width="30" Height="30" Source="/Resources/open_file.png" />
                        <Button.ToolTip>
                            <ToolTip>
                                <StackPanel>
                                    <TextBlock FontWeight="Bold">Open existing C# file</TextBlock>
                                </StackPanel>
                            </ToolTip>
                        </Button.ToolTip>
                    </Button>

                    <Button 
                        Margin="10,5"                           
                        Width="40"  
                        Height="40"
                        helpers:ButtonHelper.CornerRadius="10"   
                        IsEnabled="{Binding IsSortEnabled}"
                        Command="{Binding SortLinesCommand}"
                        Style="{StaticResource RoundedButtonStyle}">
                        <Image Width="30" Height="30" Source="/Resources/sort.png" />
                        <Button.ToolTip>
                            <ToolTip>
                                <StackPanel>
                                    <TextBlock FontWeight="Bold">Sort properties alphabetically</TextBlock>
                                </StackPanel>
                            </ToolTip>
                        </Button.ToolTip>
                    </Button>

                    <Button 
                            Margin="10,5"                           
                            Width="40"  
                            Height="40"
                            IsEnabled="{Binding InputText, Converter={StaticResource StringNotEmptyConverter}}"
                            Command="{Binding ClearAllCommand}" 
                            helpers:ButtonHelper.CornerRadius="10"
                            Style="{StaticResource RoundedButtonStyle}">
                        <Image Width="30" Height="30" Source="/Resources/clear.png" />
                        <Button.ToolTip>
                            <ToolTip>
                                <StackPanel>
                                    <TextBlock FontWeight="Bold">Clear input panel</TextBlock>
                                </StackPanel>
                            </ToolTip>
                        </Button.ToolTip>
                    </Button>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Grid.Column="2" Grid.Row="3" Grid.ColumnSpan="2" HorizontalAlignment="Right">
                    <Button 
                        Margin="10,5"                           
                        Width="40"  
                        Height="40"
                        helpers:ButtonHelper.CornerRadius="10" 
                        IsEnabled="{Binding IsSaveFileEnabled}"
                        Command="{Binding SaveFileCommand}"
                        Style="{StaticResource RoundedButtonStyle}">
                        <Image Width="30" Height="30" Source="/Resources/save.png"/>
                        <Button.ToolTip>
                            <ToolTip>
                                <StackPanel>
                                    <TextBlock FontWeight="Bold">Save to a file</TextBlock>
                                </StackPanel>
                            </ToolTip>
                        </Button.ToolTip>
                    </Button>

                    <Button 
                        Margin="10,5"                           
                        Width="40"  
                        Height="40"
                        helpers:ButtonHelper.CornerRadius="10"
                        IsEnabled="{Binding GeneratedCode, Converter={StaticResource StringNotEmptyConverter}}"
                        Command="{Binding CopyToClipboardCommand}"
                        Style="{StaticResource RoundedButtonStyle}">
                        <Image Width="30" Height="30" Source="/Resources/clipboard.png"/>
                        <Button.ToolTip>
                            <ToolTip>
                                <StackPanel>
                                    <TextBlock FontWeight="Bold">Copy to Clipboard</TextBlock>
                                </StackPanel>
                            </ToolTip>
                        </Button.ToolTip>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>
                
        <Border  Grid.Column="0" Grid.Row="2" Margin="5" Padding="5" BorderThickness="2" BorderBrush="Red" CornerRadius="5" Background="White">
            <avalon:TextEditor 
                x:Name="InputText"                
                behavior:AvalonEditBehavior.Text="{Binding InputText, Mode=TwoWay}" 
                FontFamily="Consolas" 
                FontSize="12pt"
                Padding="10,5,0,0"                
                ShowLineNumbers="{Binding IsFileParser, Converter={StaticResource InverseBooleanConverter}}"
                Loaded="InputText_Loaded"                     
                PreviewDragOver="InputText_PreviewDragOver"                
                helpers:DropCommandHelper.DropCommand="{Binding HandleDropCommand}"
                IsReadOnly="{Binding IsFileParser}" >
                <avalon:TextEditor.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Copy" Command="{Binding CopyInputCommand}" />
                        <MenuItem Header="Paste" Command="{Binding PasteInputCommand}" />
                        <MenuItem Header="Cut" Command="{Binding CutInputCommand}" />
                        <Separator />
                        <MenuItem Header="Select All" Command="{Binding SelectAllInputCommand}" />
                    </ContextMenu>
                </avalon:TextEditor.ContextMenu>
            </avalon:TextEditor>
        </Border>

        <GridSplitter Grid.Column="1" Grid.Row="2"  Width="4" Background="Gray" HorizontalAlignment="Stretch" ResizeBehavior="PreviousAndNext" Margin="0,5"/>
               
        <Border  Grid.Column="2" Grid.Row="2" Margin="5" Padding="5" BorderThickness="2" BorderBrush="Red" CornerRadius="5" Background="WhiteSmoke">
            <avalon:TextEditor  
                    x:Name="OutputText"               
                    behavior:AvalonEditBehavior.Text="{Binding GeneratedCode, Mode=TwoWay}" 
                    FontFamily="Consolas" 
                    FontSize="12pt"
                    Padding="10,5,0,0"                
                    Background="WhiteSmoke"
                    SyntaxHighlighting="C#"
                    IsReadOnly="True" >
                <avalon:TextEditor.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Copy" Command="{Binding CopyOutputCommand}" />
                        <Separator />
                        <MenuItem Header="Select All" Command="{Binding SelectAllOutputCommand}" />
                    </ContextMenu>
                </avalon:TextEditor.ContextMenu>
            </avalon:TextEditor>
        </Border>

        <GridSplitter Grid.Column="0" Grid.Row="3" Grid.ColumnSpan="3"  
                      Height="4" Background="Gray"                       
                      HorizontalAlignment="Stretch" 
                      ResizeBehavior="PreviousAndNext" Margin="5,0"/>

        <Border  Grid.Column="0" Grid.Row="4" Grid.ColumnSpan="3" Margin="5,5,5,10" Padding="5" BorderThickness="2" BorderBrush="Red" CornerRadius="5" Background="White">
            <ScrollViewer VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Auto"
                      behavior:ScrollViewerBehavior.AutoScroll="True">
                <TextBlock
                     Text="{Binding StatusText}"                       
                     FontFamily="Consolas"
                     FontSize="10pt" />
            </ScrollViewer>
        </Border>
    </Grid>
</Window>
